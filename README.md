
# FileService — Тестовое задание

Это тестовое задание — веб-приложение для управления файловым хранилищем.

---

## Описание

Приложение позволяет загружать, получать, обновлять, удалять и скачивать файлы.

## Запуск приложения

### Через Docker Compose

```bash
docker-compose up --build
```

Это запустит сервис с необходимой базой данных и приложением.

---

### Без Docker

1. Убедитесь, что у вас установлен Python 3.12+.
2. Создайте и настройте базу данных согласно конфигу.
3. Установите зависимости:

```bash
pip install -r requirements.txt
```

4. Запустите приложение:

```bash
uwsgi --ini ../uwsgi.ini
```

---

## Конфигурация

### config.yaml

```yaml
app_host: "0.0.0.0"
app_port: 80

pg:
  host: "db"
  port: 5432
  user: "test"
  password: "123"
  database: "test"

logging:
  root_log_level: 10
  modules:
    - name: "files"
      log_level: 10
    - name: "pg"
      log_level: 10

upload_dir: "/uploads"
```

### Переменные окружения (опциональные)

* YAML_PATH=/config.yaml
* APP_HOST=0.0.0.0
* APP_PORT=80
* UPLOAD_DIR=/uploads

---

## Основные маршруты API

### Получить список файлов

```
GET /api/files
```

- Возвращает список файлов с пагинацией и фильтрацией по пути.
- Параметры запроса:

| Параметр      | Тип    | Описание                   | По умолчанию |
|---------------|--------|----------------------------|--------------|
| page          | int    | Номер страницы             | 1            |
| page_size     | int    | Размер страницы            | 20           |
| path_contains | string | Фильтр по пути файлов      | отсутствует  |

---

### Получить файл по ID

```
GET /api/file/<int:file_id>
```

- Возвращает информацию о файле по его ID.

---

### Удалить файл

```
DELETE /api/file/<int:file_id>
```

- Удаляет файл по ID.

---

### Обновить данные файла

```
PATCH /api/file
```

- Обновляет название, путь и/или комментарий к файлу, а так же расположение файла в хранилище.
- В теле запроса передаются поля:

```json
{
  "id": 123,
  "name": "new_name",
  "path": "/new/path",
  "comment": "new comment"
}
```
---

### Загрузить файл

```
POST /api/file
```
- form-data
- Параметры формы:

| Параметр | Описание               | Обязательный |
|----------|------------------------|--------------|
| upload   | Файл                   | Да           |
| path     | Путь для файла         | Да           |
| comment  | Комментарий к файлу    | Нет          |

---

### Скачать файл

```
GET /api/file/<int:file_id>/download
```

- Скачивает файл по ID.
- Возвращает бинарные данные.

---

